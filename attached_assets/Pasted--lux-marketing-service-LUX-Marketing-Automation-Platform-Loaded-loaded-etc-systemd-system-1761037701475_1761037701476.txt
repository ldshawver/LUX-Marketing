● lux-marketing.service - LUX Marketing Automation Platform
     Loaded: loaded (/etc/systemd/system/lux-marketing.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-10-21 09:07:08 UTC; 10ms ago
   Main PID: 2214 ((gunicorn))
      Tasks: 1 (limit: 9517)
     Memory: 316.0K
        CPU: 5ms
     CGroup: /system.slice/lux-marketing.service
             └─2214 "(gunicorn)"

Oct 21 09:07:08 lux systemd[1]: Started lux-marketing.service - LUX Marketing Automation Platform.
root@lux:/var/www/lux-marketing# # On VPS - Fix duplicate route definitions
cd /var/www/lux-marketing

# Check for duplicate segments/automations functions
grep -n "def segments\|def automations" routes.py

# Remove the duplicates - keep only one set
cat > fix_duplicates.py << 'PYFIX'
with open('routes.py', 'r') as f:
    lines = f.readlines()

# Find all occurrences of def segments and def automations
segments_lines = []
automations_lines = []

for i, line in enumerate(lines):
    if 'def segments():' in line or 'def segments(' in line:
        segments_lines.append(i)
    if 'def automations():' in line or 'def automations(' in line:
        automations_lines.append(i)

print(f"Found segments at lines: {[l+1 for l in segments_lines]}")
print(f"Found automations at lines: {[l+1 for l in automations_lines]}")

# If duplicates exist, we need to remove them manually
# Let's just check what exists
if len(segments_lines) > 1:
    print("ERROR: Multiple segments() definitions found!")
if len(automations_lines) > 1:
    print("ERROR: Multiple automations() definitions found!")
PYFIX

python3 fix_duplicates.py
rm fix_duplicates.py

# Show all segments and automations route definitions
echo "=== All segments/automations routes ==="
grep -B2 "def segments\|def automations\|def create_segment\|def create_automation" routes.py | head -40
287:def segments():
379:def segments():
419:def automations():
Found segments at lines: [287, 379]
Found automations at lines: [419]
ERROR: Multiple segments() definitions found!
=== All segments/automations routes ===
@main_bp.route('/segments')
@login_required
def segments():
--
@main_bp.route('/segments')
@login_required
def segments():
--
@main_bp.route('/segments/create', methods=['GET', 'POST'])
@login_required
def create_segment():
--
@main_bp.route('/automations')
@login_required
def automations():
--
@main_bp.route('/automations/create', methods=['GET', 'POST'])
@login_required
def create_automation():