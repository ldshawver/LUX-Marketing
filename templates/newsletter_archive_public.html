{% extends "base.html" %}

{% block title %}Newsletter Archive - LUX Marketing{% endblock %}

{% block content %}
<div class="container-fluid py-5" style="background: linear-gradient(135deg, #000000 0%, #301934 100%); min-height: 40vh;">
    <div class="container">
        <div class="row justify-content-center text-center text-white">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold mb-3">
                    <i data-feather="archive" class="text-warning me-3"></i>
                    Newsletter Archive
                </h1>
                <p class="lead">Browse our complete collection of newsletters and marketing insights.</p>
            </div>
        </div>
    </div>
</div>

<div class="container py-5">
    {% if newsletters %}
    <div class="row">
        {% for newsletter in newsletters %}
        <div class="col-lg-6 col-xl-4 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body d-flex flex-column">
                    <div class="mb-3">
                        <h5 class="card-title">{{ newsletter.title }}</h5>
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="text-muted">
                                <i data-feather="calendar" style="width: 14px; height: 14px;"></i>
                                {{ newsletter.published_at.strftime('%B %d, %Y') }}
                            </small>
                            <span class="badge bg-primary">
                                <i data-feather="eye" style="width: 12px; height: 12px;"></i>
                                {{ newsletter.view_count }} views
                            </span>
                        </div>
                    </div>
                    
                    <!-- Newsletter Preview -->
                    {% if newsletter.html_content %}
                    <div class="newsletter-preview mb-3">
                        {{ newsletter.html_content|truncate(200)|safe }}
                    </div>
                    {% endif %}
                    
                    <div class="mt-auto">
                        <a href="{{ url_for('main.view_newsletter', slug=newsletter.slug) }}" 
                           class="btn btn-outline-primary w-100">
                            <i data-feather="book-open"></i> Read Newsletter
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <!-- Pagination could be added here -->
    {% if newsletters|length >= 12 %}
    <div class="row mt-5">
        <div class="col-12 text-center">
            <button class="btn btn-outline-primary" onclick="loadMore()">
                <i data-feather="chevron-down"></i> Load More Newsletters
            </button>
        </div>
    </div>
    {% endif %}
    
    {% else %}
    <!-- Empty State -->
    <div class="row">
        <div class="col-12">
            <div class="text-center py-5">
                <i data-feather="archive" class="text-muted" style="width: 4rem; height: 4rem;"></i>
                <h3 class="mt-4">No Newsletters Yet</h3>
                <p class="text-muted">Our newsletter archive is currently being built. Check back soon for marketing insights and updates!</p>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<!-- Subscription CTA Section -->
<div class="container-fluid py-5" style="background-color: #f8f9fa;">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <h3 class="mb-3">Stay Updated</h3>
                <p class="text-muted mb-4">Subscribe to our newsletter to receive the latest marketing insights and automation tips directly in your inbox.</p>
                
                <form class="row g-3 justify-content-center" id="subscribeForm">
                    <div class="col-md-6">
                        <input type="email" class="form-control" placeholder="Enter your email address" required>
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-primary">
                            <i data-feather="mail"></i> Subscribe
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<style>
.newsletter-preview {
    max-height: 120px;
    overflow: hidden;
    position: relative;
}

.newsletter-preview::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 30px;
    background: linear-gradient(transparent, white);
}

.card:hover {
    transform: translateY(-2px);
    transition: transform 0.2s ease-in-out;
}
</style>

<script>
function loadMore() {
    // Implement pagination/loading functionality
    alert('Load more functionality would be implemented here');
}

document.getElementById('subscribeForm').addEventListener('submit', function(e) {
    e.preventDefault();
    // Implement subscription functionality
    alert('Subscription functionality would be integrated with your forms system');
});
</script>
{% endblock %}